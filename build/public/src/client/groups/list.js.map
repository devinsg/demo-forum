{"version":3,"sources":["public/src/client/groups/list.js"],"names":["define","infinitescroll","Benchpress","api","Groups","init","loadMoreGroups","$","on","bootbox","prompt","name","length","post","then","res","ajaxify","go","slug","params","utils","val","sort","search","direction","loadMore","after","attr","data","done","groups","parse","html","append","nextStart","groupsEl","queryEl","sortEl","socket","emit","query","options","filterHidden","showMembers","hideEphemeralGroups","err","app","alertError","message","filter","group","empty"],"mappings":"AAAA,aAEAA,OAAO,qBACN,uBAAwB,aAAc,OACpC,SAAUC,EAAgBC,EAAYC,GACxC,IAAIC,KAEJA,EAAOC,KAAO,WACbJ,EAAeI,KAAKD,EAAOE,gBAG3BC,EAAE,6BAA6BC,GAAG,QAAS,WAC1CC,QAAQC,OAAO,kCAAmC,SAAUC,GAC3D,GAAIA,GAAQA,EAAKC,OAAQ,CACxBT,EAAIU,KAAK,WACRF,KAAMA,IACJG,KAAMC,IACRC,QAAQC,GAAG,UAAYF,EAAIG,aAK/B,IAAIC,EAASC,MAAMD,SACnBZ,EAAE,gBAAgBc,IAAIF,EAAOG,MAAQ,SAGrCf,EAAE,gBAAgBC,GAAG,QAASJ,EAAOmB,QACrChB,EAAE,kBAAkBC,GAAG,QAASJ,EAAOmB,QACvChB,EAAE,gBAAgBC,GAAG,SAAU,WAC9BQ,QAAQC,GAAG,eAAiBV,EAAE,gBAAgBc,UAIhDjB,EAAOE,eAAiB,SAAUkB,GACjC,GAAIA,EAAY,EAAG,CAClB,OAGDvB,EAAewB,SAAS,mBACvBH,KAAMf,EAAE,gBAAgBc,MACxBK,MAAOnB,EAAE,kCAAkCoB,KAAK,mBAC9C,SAAUC,EAAMC,GAClB,GAAID,GAAQA,EAAKE,OAAOlB,OAAQ,CAC/BV,EAAW6B,MAAM,wBAChBD,OAAQF,EAAKE,QACX,SAAUE,GACZzB,EAAE,gBAAgB0B,OAAOD,GACzBH,UAEK,CACNA,IAGD,GAAID,GAAQA,EAAKM,UAAW,CAC3B3B,EAAE,kCAAkCoB,KAAK,iBAAkBC,EAAKM,eAKnE9B,EAAOmB,OAAS,WACf,IAAIY,EAAW5B,EAAE,gBACjB,IAAI6B,EAAU7B,EAAE,gBAChB,IAAI8B,EAAS9B,EAAE,gBAEf+B,OAAOC,KAAK,iBACXC,MAAOJ,EAAQf,MACfoB,SACCnB,KAAMe,EAAOhB,MACbqB,aAAc,KACdC,YAAa,KACbC,oBAAqB,OAEpB,SAAUC,EAAKf,GACjB,GAAIe,EAAK,CACR,OAAOC,IAAIC,WAAWF,EAAIG,SAE3BlB,EAASA,EAAOmB,OAAO,SAAUC,GAChC,OAAOA,EAAMvC,OAAS,oBAAsBuC,EAAMvC,OAAS,WAE5DT,EAAW6B,MAAM,wBAChBD,OAAQA,GACN,SAAUE,GACZG,EAASgB,QAAQlB,OAAOD,OAG1B,OAAO,OAGR,OAAO5B","file":"public/src/client/groups/list.js","sourcesContent":["'use strict';\n\ndefine('forum/groups/list', [\n\t'forum/infinitescroll', 'benchpress', 'api',\n], function (infinitescroll, Benchpress, api) {\n\tvar Groups = {};\n\n\tGroups.init = function () {\n\t\tinfinitescroll.init(Groups.loadMoreGroups);\n\n\t\t// Group creation\n\t\t$('button[data-action=\"new\"]').on('click', function () {\n\t\t\tbootbox.prompt('[[groups:new-group.group_name]]', function (name) {\n\t\t\t\tif (name && name.length) {\n\t\t\t\t\tapi.post('/groups', {\n\t\t\t\t\t\tname: name,\n\t\t\t\t\t}).then((res) => {\n\t\t\t\t\t\tajaxify.go('groups/' + res.slug);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tvar params = utils.params();\n\t\t$('#search-sort').val(params.sort || 'alpha');\n\n\t\t// Group searching\n\t\t$('#search-text').on('keyup', Groups.search);\n\t\t$('#search-button').on('click', Groups.search);\n\t\t$('#search-sort').on('change', function () {\n\t\t\tajaxify.go('groups?sort=' + $('#search-sort').val());\n\t\t});\n\t};\n\n\tGroups.loadMoreGroups = function (direction) {\n\t\tif (direction < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tinfinitescroll.loadMore('groups.loadMore', {\n\t\t\tsort: $('#search-sort').val(),\n\t\t\tafter: $('[component=\"groups/container\"]').attr('data-nextstart'),\n\t\t}, function (data, done) {\n\t\t\tif (data && data.groups.length) {\n\t\t\t\tBenchpress.parse('partials/groups/list', {\n\t\t\t\t\tgroups: data.groups,\n\t\t\t\t}, function (html) {\n\t\t\t\t\t$('#groups-list').append(html);\n\t\t\t\t\tdone();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tdone();\n\t\t\t}\n\n\t\t\tif (data && data.nextStart) {\n\t\t\t\t$('[component=\"groups/container\"]').attr('data-nextstart', data.nextStart);\n\t\t\t}\n\t\t});\n\t};\n\n\tGroups.search = function () {\n\t\tvar groupsEl = $('#groups-list');\n\t\tvar queryEl = $('#search-text');\n\t\tvar sortEl = $('#search-sort');\n\n\t\tsocket.emit('groups.search', {\n\t\t\tquery: queryEl.val(),\n\t\t\toptions: {\n\t\t\t\tsort: sortEl.val(),\n\t\t\t\tfilterHidden: true,\n\t\t\t\tshowMembers: true,\n\t\t\t\thideEphemeralGroups: true,\n\t\t\t},\n\t\t}, function (err, groups) {\n\t\t\tif (err) {\n\t\t\t\treturn app.alertError(err.message);\n\t\t\t}\n\t\t\tgroups = groups.filter(function (group) {\n\t\t\t\treturn group.name !== 'registered-users' && group.name !== 'guests';\n\t\t\t});\n\t\t\tBenchpress.parse('partials/groups/list', {\n\t\t\t\tgroups: groups,\n\t\t\t}, function (html) {\n\t\t\t\tgroupsEl.empty().append(html);\n\t\t\t});\n\t\t});\n\t\treturn false;\n\t};\n\n\treturn Groups;\n});\n"]}