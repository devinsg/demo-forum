"use strict";define("forum/account/settings",["forum/account/header","components","translator"],function(e,t,a){var n={};$(window).on("action:ajaxify.start",function(){if(ajaxify.data.template.name==="account/settings"&&$("#bootswatchSkin").val()!==config.bootswatchSkin){s(config.bootswatchSkin)}});n.init=function(){e.init();$("#submitBtn").on("click",function(){var e=i();if(e.homePageRoute==="custom"&&e.homePageCustom){$.get(config.relative_path+"/"+e.homePageCustom,function(){r(e)}).fail(function(){app.alertError("[[error:invalid-home-page-route]]")})}else{r(e)}return false});$("#bootswatchSkin").on("change",function(){s($(this).val())});$('[data-property="homePageRoute"]').on("change",o);o();t.get("user/sessions").find(".timeago").timeago()};function i(){var e={};$(".account").find("input, textarea, select").each(function(t,a){a=$(a);var n=a.attr("data-property");if(a.is("select")){e[n]=a.val();return}switch(a.attr("type")){case"text":case"textarea":e[n]=a.val();break;case"checkbox":e[n]=a.is(":checked")?1:0;break}});return e}function r(e){socket.emit("user.saveSettings",{uid:ajaxify.data.theirid,settings:e},function(e,t){if(e){return app.alertError(e.message)}app.alertSuccess("[[success:settings-saved]]");var n=false;for(var i in t){if(t.hasOwnProperty(i)){if(i==="userLang"&&config.userLang!==t.userLang){n=true}if(config.hasOwnProperty(i)){config[i]=t[i]}}}if(n&&parseInt(app.user.uid,10)===parseInt(ajaxify.data.theirid,10)){a.translate("[[language:dir]]",config.userLang,function(e){var t=$("html");t.attr("data-dir",e);t.css("direction",e)});a.switchTimeagoLanguage(utils.userLangToTimeagoCode(config.userLang),function(){overrides.overrideTimeago();ajaxify.refresh()})}})}function o(){if($('[data-property="homePageRoute"]').val()==="custom"){$("#homePageCustom").show()}else{$("#homePageCustom").hide();$('[data-property="homePageCustom"]').val("")}}function s(e){var t=Array.prototype.filter.call(document.querySelectorAll('link[rel="stylesheet"]'),function(e){return e.href.indexOf(config.relative_path+"/assets/client")!==-1})[0]||null;if(!t){return}var a=$("body").attr("class").split(/\s+/).filter(function(e){return e.startsWith("skin-")});if(!a[0]){return}var n=a[0].slice(5);n=n!=="noskin"?n:"";if(e===n){return}var i=document.createElement("link");i.rel="stylesheet";i.type="text/css";i.href=config.relative_path+"/assets/client"+(e?"-"+e:"")+".css";i.onload=function(){t.parentNode.removeChild(t);$("body").removeClass(a.join(" "));$("body").addClass("skin-"+(e||"noskin"))};document.head.appendChild(i)}return n});
//# sourceMappingURL=settings.js.map