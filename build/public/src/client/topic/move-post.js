"use strict";define("forum/topic/move-post",["components","postSelect","translator","alerts"],function(t,i,e,a){var o={};var n;var s;var d;o.init=function(t){if(n){return}d=ajaxify.data.tid;app.parseAndTranslate("modals/move-post",{},function(e){n=e;s=n.find("#move_posts_confirm");$("body").append(n);n.find(".close,#move_posts_cancel").on("click",r);i.init(f);p();if(t){i.togglePostSelection(t,t.attr("data-pid"))}$(window).off("action:axajify.end",c).on("action:ajaxify.end",c);s.on("click",function(){s.attr("disabled",true);a.alert({alert_id:"pids_move_"+i.pids.join("-"),title:"[[topic:thread_tools.move-posts]]",message:"[[topic:topic_move_posts_success]]",type:"success",timeout:1e4,timeoutfn:function(){l()},clickfn:function(t,i){delete i.timeoutfn;app.alertSuccess("[[topic:topic_move_posts_undone]]");s.removeAttr("disabled")}})})})};function p(){if(!n){return}if(i.pids.length){if(ajaxify.data.template.topic&&ajaxify.data.tid&&ajaxify.data.tid!==d){var t=e.compile("topic:x-posts-will-be-moved-to-y",i.pids.length,ajaxify.data.title);n.find("#pids").translateHtml(t)}else{n.find("#pids").translateHtml("[[topic:x-posts-selected, "+i.pids.length+"]]")}}else{n.find("#pids").translateHtml("[[topic:no-posts-selected]]")}}function c(){if(!n){return}if(i.pids.length&&ajaxify.data.tid&&ajaxify.data.template.topic&&ajaxify.data.tid!==d){s.removeAttr("disabled")}else{s.attr("disabled",true)}p()}function f(){c()}function l(){if(!ajaxify.data.template.topic||!ajaxify.data.tid){return}socket.emit("posts.movePosts",{pids:i.pids,tid:ajaxify.data.tid},function(e){if(e){return app.alertError(e.message)}i.pids.forEach(function(i){t.get("post","pid",i).fadeOut(500,function(){$(this).remove()})});r()})}function r(){if(n){n.remove();n=null;i.disable()}}return o});
//# sourceMappingURL=move-post.js.map