"use strict";define("admin/manage/groups",["categorySelector","api"],function(a,e){var t={};var r=0;t.init=function(){var a=$("#create-modal");var t=$("#create-group-name");var r=$("#create-modal-go");var i=$("#create-modal-error");o();a.on("keypress",function(a){if(a.keyCode===13){r.click()}});$("#create").on("click",function(){a.modal("show");setTimeout(function(){t.focus()},250)});r.on("click",function(){var r={name:t.val(),description:$("#create-group-desc").val(),private:$("#create-group-private").is(":checked")?1:0,hidden:$("#create-group-hidden").is(":checked")?1:0};e.post("/groups",r,e=>{i.addClass("hide");t.val("");a.on("hidden.bs.modal",function(){ajaxify.go("admin/manage/groups/"+e.name)});a.modal("hide")}).catch(a=>{if(!utils.hasLanguageKey(a.status.message)){a.status.message="[[admin/manage/groups:alerts.create-failure]]"}i.translateHtml(a.status.message).removeClass("hide")})});$(".groups-list").on("click","[data-action]",function(){var a=$(this);var e=a.attr("data-action");var t=a.parents("tr[data-groupname]").attr("data-groupname");switch(e){case"delete":bootbox.confirm("[[admin/manage/groups:alerts.confirm-delete]]",function(a){if(a){socket.emit("groups.delete",{groupName:t},function(a){if(a){return app.alertError(a.message)}ajaxify.refresh()})}});break}});n()};function n(){$('.groups-list [component="category-selector"]').each(function(){var e=$(this).parents("[data-name-encoded]").attr("data-name-encoded");a.init($(this),function(a){ajaxify.go("admin/manage/privileges/"+a.cid+"?group="+e)})})}function o(){var a=$("#group-search");function e(){if(!a.val()){return ajaxify.refresh()}$(".pagination").addClass("hide");var e=$(".groups-list");socket.emit("groups.search",{query:a.val(),options:{sort:"date"}},function(a,t){if(a){return app.alertError(a.message)}app.parseAndTranslate("admin/manage/groups","groups",{groups:t,categories:ajaxify.data.categories},function(a){e.find("[data-groupname]").remove();e.find("tbody").append(a);n()})})}a.on("keyup",function(){if(r){clearTimeout(r);r=0}r=setTimeout(e,200)})}return t});
//# sourceMappingURL=groups.js.map